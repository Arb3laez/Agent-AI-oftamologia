version: '3.8'

services:
  # ==========================================
  # ORCHESTRATOR
  # ==========================================
  orchestrator:
    build:
      context: .
      dockerfile: Dockerfile.orchestrator
    container_name: ophthalmology-orchestrator
    ports:
      - "8000:8000"
    env_file:
      - .env
    environment:
      - URL_AGENT_GENERAL=http://agent-general:8000
      - URL_AGENT_RETINA=http://agent-retina:8000
      - URL_AGENT_CORNEA=http://agent-cornea:8000
      - URL_AGENT_NEURO=http://agent-neuro:8000
      - URL_AGENT_DIRECTOR=http://agent-director:8000
    depends_on:
      - agent-general
      - agent-retina
      - agent-cornea
      - agent-neuro
      - agent-director
    networks:
      - ophthalmology-network

  # ==========================================
  # AGENTS
  # ==========================================
  agent-general:
    build:
      context: .
      dockerfile: Dockerfile.agent
    container_name: agent-general
    env_file:
      - .env
    environment:
      - AGENT_TYPE=GENERAL
    networks:
      - ophthalmology-network

  agent-retina:
    build:
      context: .
      dockerfile: Dockerfile.agent
    container_name: agent-retina
    env_file:
      - .env
    environment:
      - AGENT_TYPE=RETINA
    networks:
      - ophthalmology-network

  agent-cornea:
    build:
      context: .
      dockerfile: Dockerfile.agent
    container_name: agent-cornea
    env_file:
      - .env
    environment:
      - AGENT_TYPE=CORNEA
    networks:
      - ophthalmology-network

  agent-neuro:
    build:
      context: .
      dockerfile: Dockerfile.agent
    container_name: agent-neuro
    env_file:
      - .env
    environment:
      - AGENT_TYPE=NEURO
    networks:
      - ophthalmology-network

  agent-director:
    build:
      context: .
      dockerfile: Dockerfile.agent
    container_name: agent-director
    env_file:
      - .env
    environment:
      - AGENT_TYPE=DIRECTOR
    networks:
      - ophthalmology-network

networks:
  ophthalmology-network:
    driver: bridge
